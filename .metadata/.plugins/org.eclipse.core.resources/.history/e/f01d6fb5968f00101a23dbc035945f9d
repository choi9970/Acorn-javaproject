package DashBoard;

import java.io.*;
import java.util.*;

public class BoardManager {
    Scanner sc = new Scanner(System.in);
    List<Board> list = new ArrayList<>();

    // ê²Œì‹œê¸€ ì‘ì„±
    public void postCreate(String writer, String title, String content) {
        list = FileManager.loadData(); // ê¸°ì¡´ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
        Board board = new Board(enterNumber(), title, content, writer, nowDate());
        list.add(board);
        FileManager.saveData(list); // íŒŒì¼ ì €ì¥
    }

    // ê²Œì‹œê¸€ ì¡°íšŒ ë©”ë‰´
    public void postShowChoice() throws IOException {
        System.out.println("\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”");
        System.out.println("â”‚                         ğŸ“– ê²Œì‹œê¸€ ì¡°íšŒ ë©”ë‰´                          â”‚");
        System.out.println("â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤");
        System.out.println("â”‚                          [1] ì „ì²´ ëª©ë¡ ì¡°íšŒ                             â”‚");
        System.out.println("â”‚                          [2] ê²Œì‹œê¸€ ìƒì„¸ë³´ê¸°                          â”‚");
        System.out.println("â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜");
        System.out.print("ğŸ‘‰ ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”: ");
        String strListChoice = sc.next();

        try {
            int intListChoice = Integer.parseInt(strListChoice);

            if (intListChoice == 1) {
                System.out.println("\nğŸ“‹ ì „ì²´ ê²Œì‹œê¸€ ëª©ë¡\n");
                postShowAll();

            } else if (intListChoice == 2) {
                System.out.println("\nğŸ” ê²Œì‹œê¸€ ìƒì„¸ ì¡°íšŒ");
                postShowAll();
                System.out.print("ğŸ‘‰ ì¡°íšŒí•  ê²Œì‹œê¸€ ë²ˆí˜¸ ì…ë ¥: ");
                int num = sc.nextInt();
                postShowDetail(num);
            } else {
                System.out.println("\n\nâš  1, 2ë²ˆë§Œ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì„ íƒí•´ì£¼ì„¸ìš”.\n");
            }

        } catch (NumberFormatException e) {
            System.out.println("\nâš ï¸ ìˆ«ìê°€ ì•„ë‹Œ ê°’ì„ ì…ë ¥í–ˆìŠµë‹ˆë‹¤.");
        }
    }

    // ì „ì²´ ëª©ë¡ ì¡°íšŒ
    public int postShowAll() {
        list = FileManager.loadData();
        if (list.isEmpty()) {
            System.out.println("\n\nâš  ë“±ë¡ëœ ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤.\n");
            return 0;
        }
        
        Board.printHeader();   // í—¤ë” ì¶œë ¥
        for (Board board : list) {
            System.out.println(board);
        }
        Board.printFooter();   // í‘¸í„° ì¶œë ¥
        return 1;
    }

    // ìƒì„¸ë³´ê¸°
    public void postShowDetail(int id) {
        list = FileManager.loadData();
        for (Board board : list) {
            if (board.getId() == id) {
                System.out.println("\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”");
                System.out.println("â”‚                          ğŸ“Œ ê²Œì‹œê¸€ ìƒì„¸ë³´ê¸°                          â”‚");
                System.out.println("â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜");
                System.out.println("â”‚ ê¸€ë²ˆí˜¸ : " + board.getId());
                System.out.println("â”‚ ì œëª©   : " + board.getTitle());
                System.out.println("â”‚ ì‘ì„±ì : " + board.getWriter());
                System.out.println("â”‚ ì‘ì„±ì¼ : " + board.sdf.format(board.getRegDate()));
                System.out.println("â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤");
                System.out.println("â”‚ ë‚´ìš©   : " + board.getContent());
                System.out.println("â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜");
                return;
            }
        }
        System.out.println("í•´ë‹¹ ë²ˆí˜¸ì˜ ê²Œì‹œê¸€ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
    }
    
    // ê²Œì‹œê¸€ ìˆ˜ì •
    public void postUpdate(int updateId) {
    	
    }
    
    public void postUpdate(String newTitle,String newContent) {
    	//List<Board> list = FileManager.loadData();
    	list = FileManager.loadData();
    	
//    	 if (list.isEmpty()) {
//             System.out.println("[ ë“±ë¡ëœ ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤ ]");
//             return;
//         }
//    	 
//    	 int updateId;
//    	 
//    	 try {
//    	    	System.out.print("â˜‘ ìˆ˜ì •í•  ê²Œì‹œê¸€ ë²ˆí˜¸ ì…ë ¥: ");
//    	        updateId = Integer.parseInt(sc.next());
//    	    } catch (NumberFormatException e) {
//    	        System.out.println("[ âŒ ìˆ«ìë¥¼ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤. ]");
//    	        return;
//    	    }
//    	 
////    	 Board boardToUpdate = null;
////    	 for(Board board : list) {
////    		 if(board.getId() == updateId) {
////    			 boardToUpdate = board;
////    			 break;
////    		 }
//    	 }
//    	 
//    	 if (boardToUpdate == null) {
//             System.out.println("[ í•´ë‹¹ ë²ˆí˜¸ì˜ ê²Œì‹œê¸€ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤ ]");
//             return;
//         }
    	    
//    	    System.out.println("\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€");
//    	    System.out.print("ğŸ“ ìƒˆ ì œëª© ì…ë ¥: ");
//    	    String newTitle = sc.next();
//
//    	    System.out.print("ğŸ’¬ ìƒˆ ë‚´ìš© ì…ë ¥: ");
//    	    String newContent = sc.next();
//    	    System.out.println("\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€");
    	    
    	    // ì—…ë°ì´íŠ¸
    	    boardToUpdate.setTitle(newTitle);
    	    boardToUpdate.setContent(newContent);
    	    boardToUpdate.setRegDate(new Date());

    	    // ë³€ê²½ í›„ ì €ì¥
    	    FileManager.saveData(list);
    	    FileManager.saveData(list);
    	    System.out.println("[ âœ ê²Œì‹œê¸€ " + updateId + "ë²ˆì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤. ]");
    	    
    	    System.out.println("\n ğŸ“Œìˆ˜ì •ëœ ê²Œì‹œê¸€ ë‚´ìš©");
    	    System.out.println("\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€");
    	    System.out.println("ì œëª©:" +  boardToUpdate.getTitle());
    	    System.out.println("ë‚´ìš©:" +  boardToUpdate.getContent());
    	    System.out.println();
    	   
    }
    
   
    // ê²Œì‹œê¸€ ì‚­ì œ
    public void postDelete(int deleteNum) {
        list = FileManager.loadData();
        boolean removed = list.removeIf(board -> board.getId() == deleteNum);
        if (removed) {
            System.out.println("[ ğŸ—‘ï¸ê²Œì‹œê¸€ " + deleteNum + "ë²ˆì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤. ]");
            System.out.println();
            FileManager.saveData(list);
        } else {
            System.out.println("[ âŒ í•´ë‹¹ ë²ˆí˜¸ì˜ ê²Œì‹œê¸€ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ]");
        }
    }

    // í˜„ì¬ ë‚ ì§œ
    public static Date nowDate() {
        return new Date();
    }

    // ë‹¤ìŒ ê¸€ ë²ˆí˜¸ ê°€ì ¸ì˜¤ê¸°
    public static int enterNumber() {
        List<Board> list = FileManager.loadData();
        if (list.isEmpty()) {
            return 1;
        }
        return list.get(list.size() - 1).getId() + 1;
    }
}
